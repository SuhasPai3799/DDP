incoming:
if (! lastDA()) return;

/* Incoming Messages

   XXXGreeting(Meeting) -->
   currentSession.set("greetingReceived", myLastDAs.getFirst());

   Confirm(Playing, theme=Quiz)
   --> Set the activity to a new Game, and possibly extract all
   relevant data? or lazy?
*/
incoming_salutation:
if (lastDA() <= #Salutation(Meeting)) {
  if (activity <= Introduction) {
    activity.status == "active";
  } else {
    logger.warn("greeting while not doing intro.");
  }
  lastDAprocessed();
}

incoming_acceptplay:
if ((lastDA() <= #AcceptRequest(Playing) || lastDA() <= #Confirm(Playing))
    && !(activity <= Quiz)) {
  activity = newActivity(new Quiz);
  if (! activity.status || activity.status == "none") {
    activity.hasParticipant = user;
    activity.status = "started";
    activity.tabletOrientation = user;
  }
  lastDAprocessed();
}

incoming_rejectplay:
if ((lastDA() <= #RejectRequest(Playing) || lastDA() <= #Disconfirm(Playing))
    && activity && !(activity <= Quiz) && !(activity <= Closing)) {
  // OK, maybe next time
  emitDA(#Disconfirm(Playing));
  newActivity(new Closing);
  lastDAprocessed();
}

